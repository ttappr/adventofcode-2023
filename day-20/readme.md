[LANGUAGE: Rust]  ðŸ¦€

My initial design was complex and problematic, so I scrapped it and found something simpler. The modules don't hold references to each other; instead they each have a string identifier and send messages to each other through a mediator object (a sort of GoF Mediator design pattern). Passing messages avoids any problems with recursion that I'd otherwise have had if modules held refs to each other and called each others' send and receive methods.

[Full Source parts 1 & 2](https://topaz.github.io/paste/#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)

    fn part_1(path: &str) -> Result<i64, Box<dyn Error>> {
        let mut modules  = parse_input(path)?; 
        let mut mediator = Mediator::new();
        let mut button   = Module::new_button("button", "broadcaster");

        for _ in 0..1000 {
            button.send_pulse(&mut mediator);
            mediator.loop_until_done(&mut modules);
        }

        let counts = mediator.get_pulse_counts();
        let total  = counts.0 * counts.1;

        println!("Part 1 Total: {}", total);
        Ok(total)
    }